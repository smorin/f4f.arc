<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text-html; charset=utf-8" /><title>8.4&nbsp;Specifying syntax with syntax classes</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="../racket.css" title="default" /><link rel="stylesheet" type="text/css" href="../scribble-style.css" title="default" /><script type="text/javascript" src="../scribble-common.js"></script></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="index.html" class="tocviewlink" pltdoc="x"><span style="font-weight: bold">Syntax</span>:<span class="mywbr"> </span> Meta-<wbr></wbr>Programming Helpers</a></td></tr></table></div><div class="tocviewsublisttop" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="syntax-helpers.html" class="tocviewlink" pltdoc="x">Syntax Object Helpers</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="module-helpers.html" class="tocviewlink" pltdoc="x">Module-<wbr></wbr>Processing Helpers</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="transformer-helpers.html" class="tocviewlink" pltdoc="x">Macro Transformer Helpers</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="reader-helpers.html" class="tocviewlink" pltdoc="x">Reader Helpers</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="toplevel.html" class="tocviewlink" pltdoc="x">Non-<wbr></wbr>Module Compilation And Expansion</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="trusted-xforms.html" class="tocviewlink" pltdoc="x">Trusting Standard Recertifying Transformers</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="docprovide.html" class="tocviewlink" pltdoc="x">Attaching Documentation to Exports</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="stxparse.html" class="tocviewselflink" pltdoc="x">Parsing and specifying syntax</a></td></tr><tr><td align="right"></td><td><a href="doc-index.html" class="tocviewlink" pltdoc="x">Index</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9660;</a></td><td>8&nbsp;</td><td><a href="stxparse.html" class="tocviewlink" pltdoc="x">Parsing and specifying syntax</a></td></tr></table><div class="tocviewsublist" style="display: block;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">8.1&nbsp;</td><td><a href="stxparse-intro.html" class="tocviewlink" pltdoc="x">Introduction</a></td></tr><tr><td align="right">8.2&nbsp;</td><td><a href="stxparse-examples.html" class="tocviewlink" pltdoc="x">Examples</a></td></tr><tr><td align="right">8.3&nbsp;</td><td><a href="Parsing_syntax.html" class="tocviewlink" pltdoc="x">Parsing syntax</a></td></tr><tr><td align="right">8.4&nbsp;</td><td><a href="" class="tocviewselflink" pltdoc="x">Specifying syntax with syntax classes</a></td></tr><tr><td align="right">8.5&nbsp;</td><td><a href="stxparse-patterns.html" class="tocviewlink" pltdoc="x">Syntax patterns</a></td></tr><tr><td align="right">8.6&nbsp;</td><td><a href="Literal_sets_and_Conventions.html" class="tocviewlink" pltdoc="x">Literal sets and Conventions</a></td></tr><tr><td align="right">8.7&nbsp;</td><td><a href="Library_syntax_classes_and_literal_sets.html" class="tocviewlink" pltdoc="x">Library syntax classes and literal sets</a></td></tr><tr><td align="right">8.8&nbsp;</td><td><a href="Debugging_and_inspection_tools.html" class="tocviewlink" pltdoc="x">Debugging and inspection tools</a></td></tr><tr><td align="right">8.9&nbsp;</td><td><a href="Experimental.html" class="tocviewlink" pltdoc="x">Experimental</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_2&quot;);">&#9658;</a></td><td>8.4&nbsp;</td><td><a href="" class="tocviewselflink" pltdoc="x">Specifying syntax with syntax classes</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_2"><table cellspacing="0" cellpadding="0"><tr><td align="right">8.4.1&nbsp;</td><td><a href="#(part._.Pattern_directives)" class="tocviewlink" pltdoc="x">Pattern directives</a></td></tr><tr><td align="right">8.4.2&nbsp;</td><td><a href="#(part._.Pattern_variables_and_attributes)" class="tocviewlink" pltdoc="x">Pattern variables and attributes</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><a href="#(form._((lib._syntax/parse..rkt)._define-syntax-class))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: syntax/parse"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>syntax-<wbr></wbr>class</span></span></span></a></td></tr><tr><td><a href="#(form._((lib._syntax/parse..rkt)._define-splicing-syntax-class))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: syntax/parse"><span class="RktSym"><span class="RktStxLink">define-<wbr></wbr>splicing-<wbr></wbr>syntax-<wbr></wbr>class</span></span></span></a></td></tr><tr><td><a href="#(form._((lib._syntax/parse..rkt)._pattern))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: syntax/parse"><span class="RktSym"><span class="RktStxLink">pattern</span></span></span></a></td></tr><tr><td><span class="tocsublinknumber">8.4.1<tt>&nbsp;</tt></span><a href="#(part._.Pattern_directives)" class="tocsubseclink" pltdoc="x">Pattern directives</a></td></tr><tr><td><span class="tocsublinknumber">8.4.2<tt>&nbsp;</tt></span><a href="#(part._.Pattern_variables_and_attributes)" class="tocsubseclink" pltdoc="x">Pattern variables and attributes</a></td></tr><tr><td><a href="#(form._((lib._syntax/parse..rkt)._attribute))" class="tocsubnonseclink" pltdoc="x"><span title="Provided from: syntax/parse"><span class="RktSym"><span class="RktStxLink">attribute</span></span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;5.0.2&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }" /></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" pltdoc="x" onclick="return GotoPLTRoot(&quot;5.0.2&quot;);">top</a></span><span class="navright"><a href="Parsing_syntax.html" title="backward to &quot;8.3 Parsing syntax&quot;" pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="stxparse.html" title="up to &quot;8 Parsing and specifying syntax&quot;" pltdoc="x">up</a>&nbsp;&nbsp;<a href="stxparse-patterns.html" title="forward to &quot;8.5 Syntax patterns&quot;" pltdoc="x">next &rarr;</a></span>&nbsp;</div><h4>8.4<tt>&nbsp;</tt><a name="(part._stxparse-specifying)"></a>Specifying syntax with syntax classes</h4><p>Syntax classes provide an abstraction mechanism for <a href="stxparse-patterns.html#(tech._syntax._pattern)" class="techoutside" pltdoc="x"><span class="techinside">syntax
patterns</span></a>. Built-in syntax classes are supplied that recognize basic
classes such as <span class="RktSym"><a href="Library_syntax_classes_and_literal_sets.html#(form._((lib._syntax/parse..rkt)._identifier))" class="RktStxLink" pltdoc="x">identifier</a></span> and <span class="RktSym"><a href="Library_syntax_classes_and_literal_sets.html#(form._((lib._syntax/parse..rkt)._keyword))" class="RktStxLink" pltdoc="x">keyword</a></span>.  Programmers
can compose basic syntax classes to build specifications of more
complex syntax, such as lists of distinct identifiers and formal
arguments with keywords. Macros that manipulate the same syntactic
structures can share syntax class definitions.</p><p><div class="SIntrapara"><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._syntax/parse..rkt)._define-syntax-class))"></a><a name="(form._((lib._syntax/parse..rkt)._define-syntax-class))"></a><span title="Provided from: syntax/parse"><span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._define-syntax-class))" class="RktStxLink" pltdoc="x">define-syntax-class</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">name-id</span><span class="hspace">&nbsp;</span><span class="RktVar">stxclass-option</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">stxclass-variant</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._define-syntax-class))" class="RktStxLink" pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">name-id</span><span class="hspace">&nbsp;</span><span class="RktPn">. </span><span class="RktVar">kw-formals</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">stxclass-option</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">stxclass-variant</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">stxclass-option</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:attributes</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">attr-arity-decl</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:description</span><span class="hspace">&nbsp;</span><span class="RktVar">description-expr</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:opaque</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:commit</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:no-delimit-cut</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:literals</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">literal-entry</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:literal-sets</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">literal-set</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:conventions</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">convention-id</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:local-conventions</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">convention-rule</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">attr-arity-decl</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">attr-name-id</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">attr-name-id</span><span class="hspace">&nbsp;</span><span class="RktVar">depth</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td></tr><tr><td align="right" valign="baseline"><span class="RktVar">stxclass-variant</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._pattern))" class="RktStxLink" pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktVar">syntax-pattern</span><span class="hspace">&nbsp;</span><span class="RktVar">pattern-directive</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">description-expr</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/strings.html#(def._((quote._~23~25kernel)._string~3f))" class="RktValLink" pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></td></tr></table></div><div class="SIntrapara">Defines <span class="RktVar">name-id</span> as a <a name="(tech._syntax._clas)"></a><span style="font-style: italic">syntax class</span>, which
encapsulates one or more <a href="stxparse-patterns.html#(tech._single._term._pattern)" class="techoutside" pltdoc="x"><span class="techinside">single-term patterns</span></a>.</div></p><p>A syntax class may have formal parameters, in which case they are
bound as variables in the body. Syntax classes support optional
arguments and keyword arguments using the same syntax as
<span class="RktSym"><a href="../reference/lambda.html#(form._((lib._racket/private/base..rkt)._lambda))" class="RktStxLink" pltdoc="x">lambda</a></span>. The body of the syntax-class definition contains a
non-empty sequence of <span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._pattern))" class="RktStxLink" pltdoc="x">pattern</a></span> variants.</p><p>The following options are supported:</p><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:attributes</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">attr-arity-decl</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">attr-arity-decl</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">attr-id</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">(</span><span class="RktVar">attr-id</span><span class="hspace">&nbsp;</span><span class="RktVar">depth</span><span class="RktPn">)</span></td></tr></table></td></tr></table><p>Declares the attributes of the syntax class. An attribute arity
declaration consists of the attribute name and optionally its ellipsis
depth (zero if not explicitly specified).</p><p>If the attributes are not explicitly listed, they are inferred as the
set of all <a href="stxparse-patterns.html#(tech._pattern._variable)" class="techoutside" pltdoc="x"><span class="techinside">pattern variables</span></a> occurring in every variant of the
syntax class. Pattern variables that occur at different ellipsis
depths are not included, nor are nested attributes from
<a href="stxparse-patterns.html#(tech._annotated._pattern._variable)" class="techoutside" pltdoc="x"><span class="techinside">annotated pattern variables</span></a>.</p></blockquote><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:description</span><span class="hspace">&nbsp;</span><span class="RktVar">description-expr</span></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">description-expr</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/strings.html#(def._((quote._~23~25kernel)._string~3f))" class="RktValLink" pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></td></tr></table><p>The <span class="RktSym">description</span> argument is evaluated in a scope containing
the syntax class&rsquo;s parameters. If the result is a string, it is used
in error messages involving the syntax class. For example, if a term
is rejected by the syntax class, an error of the form
<span class="RktVal">"expected <span class="RktSym">description</span>"</span> may be synthesized. If
the result is <span class="RktVal">#f</span>, the syntax class is skipped in the search
for a description to report.</p><p>If the option is not given absent, the name of the syntax class is
used instead.</p></blockquote><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:opaque</span></td></tr></table><p>Indicates that errors should not be reported with respect to the
internal structure of the syntax class.</p></blockquote><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:commit</span></td></tr></table><p>Directs the syntax class to &ldquo;commit&rdquo; to the first successful
match. When a variant succeeds, all choice points within the syntax
class are discarded. See also <span class="RktSym"><a href="stxparse-patterns.html#(form._((lib._syntax/parse..rkt)._~7ecommit))" class="RktStxLink" pltdoc="x">~commit</a></span>.</p></blockquote><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:no-delimit-cut</span></td></tr></table><p>By default, a cut (<span class="RktSym"><a href="stxparse-patterns.html#(form._((lib._syntax/parse..rkt)._~7e!))" class="RktStxLink" pltdoc="x">~!</a></span>) within a syntax class only discards
choice points within the syntax class. That is, the body of the syntax
class acts as though it is wrapped in a <span class="RktSym"><a href="stxparse-patterns.html#(form._((lib._syntax/parse..rkt)._~7edelimit-cut))" class="RktStxLink" pltdoc="x">~delimit-cut</a></span> form. If
<span class="RktPn">#:no-delimit-cut</span> is specified, a cut may affect choice points
of the syntax class&rsquo;s calling context (another syntax class&rsquo;s patterns
or a <span class="RktSym"><a href="Parsing_syntax.html#(form._((lib._syntax/parse..rkt)._syntax-parse))" class="RktStxLink" pltdoc="x">syntax-parse</a></span> form).</p><p>It is an error to use both <span class="RktPn">#:commit</span> and
<span class="RktPn">#:no-delimit-cut</span>.</p></blockquote><p><div class="SIntrapara"><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:literals</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">literal-entry</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:literal-sets</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">literal-set</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table></blockquote></div><div class="SIntrapara"><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:conventions</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">convention-id</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table><p>Declares the literals and conventions that apply to the syntax class&rsquo;s
variant patterns and their immediate <span class="RktPn">#:with</span> clauses. Patterns
occuring within subexpressions of the syntax class (for example, on
the right-hand side of a <span class="RktPn">#:fail-when</span> clause) are not
affected.</p><p>These options have the same meaning as in <span class="RktSym"><a href="Parsing_syntax.html#(form._((lib._syntax/parse..rkt)._syntax-parse))" class="RktStxLink" pltdoc="x">syntax-parse</a></span>.</p></blockquote></div></p><p>Each variant of a syntax class is specified as a separate
<span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._pattern))" class="RktStxLink" pltdoc="x">pattern</a></span>-form whose syntax pattern is a <a href="stxparse-patterns.html#(tech._single._term._pattern)" class="techoutside" pltdoc="x"><span class="techinside">single-term
pattern</span></a>.</p><p><div class="SIntrapara"><table cellspacing="0" class="boxed"><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._syntax/parse..rkt)._define-splicing-syntax-class))"></a><a name="(form._((lib._syntax/parse..rkt)._define-splicing-syntax-class))"></a><span title="Provided from: syntax/parse"><span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._define-splicing-syntax-class))" class="RktStxLink" pltdoc="x">define-splicing-syntax-class</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">name-id</span><span class="hspace">&nbsp;</span><span class="RktVar">stxclass-option</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">stxclass-variant</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._define-splicing-syntax-class))" class="RktStxLink" pltdoc="x">define-splicing-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">name-id</span><span class="hspace">&nbsp;</span><span class="RktVar">kw-formals</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">stxclass-option</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">stxclass-variant</span><span class="hspace">&nbsp;</span><span class="RktMeta">...+</span><span class="RktPn">)</span></td></tr></table></td></tr></table></div><div class="SIntrapara">Defines <span class="RktVar">name-id</span> as a <a name="(tech._splicing._syntax._clas)"></a><span style="font-style: italic">splicing syntax class</span>,
analogous to a <a href="#(tech._syntax._clas)" class="techoutside" pltdoc="x"><span class="techinside">syntax class</span></a> but encapsulating <a href="stxparse-patterns.html#(tech._head._pattern)" class="techoutside" pltdoc="x"><span class="techinside">head
patterns</span></a> rather than <a href="stxparse-patterns.html#(tech._single._term._pattern)" class="techoutside" pltdoc="x"><span class="techinside">single-term patterns</span></a>.</div></p><p>The options are the same as for <span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._define-syntax-class))" class="RktStxLink" pltdoc="x">define-syntax-class</a></span>.</p><p>Each variant of a splicing syntax class is specified as a separate
<span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._pattern))" class="RktStxLink" pltdoc="x">pattern</a></span>-form whose syntax pattern is a <a href="stxparse-patterns.html#(tech._head._pattern)" class="techoutside" pltdoc="x"><span class="techinside">head pattern</span></a>.</p><p><div class="SIntrapara"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._syntax/parse..rkt)._pattern))"></a><a name="(form._((lib._syntax/parse..rkt)._pattern))"></a><span title="Provided from: syntax/parse"><span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._pattern))" class="RktStxLink" pltdoc="x">pattern</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">syntax-pattern</span><span class="hspace">&nbsp;</span><span class="RktVar">pattern-directive</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">Used to indicate a variant of a syntax class or splicing syntax
class. The variant accepts syntax matching the given syntax pattern
with the accompanying <a href="#(tech._pattern._directive)" class="techoutside" pltdoc="x"><span class="techinside">pattern directives</span></a>.</div></p><p>When used within <span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._define-syntax-class))" class="RktStxLink" pltdoc="x">define-syntax-class</a></span>, <span class="RktVar">syntax-pattern</span>
should be a <a href="stxparse-patterns.html#(tech._single._term._pattern)" class="techoutside" pltdoc="x"><span class="techinside">single-term pattern</span></a>; within
<span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._define-splicing-syntax-class))" class="RktStxLink" pltdoc="x">define-splicing-syntax-class</a></span>, it should be a <a href="stxparse-patterns.html#(tech._head._pattern)" class="techoutside" pltdoc="x"><span class="techinside">head
pattern</span></a>.</p><p>The attributes of the variant are the attributes of the pattern
together with all attributes bound by <span class="RktPn">#:with</span> clauses,
including nested attributes produced by syntax classes associated with
the pattern variables.</p><h5>8.4.1<tt>&nbsp;</tt><a name="(part._.Pattern_directives)"></a>Pattern directives</h5><p>Both the parsing forms and syntax class definition forms support
<a name="(tech._pattern._directive)"></a><span style="font-style: italic">pattern directives</span> for annotating syntax patterns and
specifying side conditions. The grammar for pattern directives
follows:</p><p><table cellspacing="0"><tr><td align="right" valign="baseline"><span class="hspace">&nbsp;&nbsp;</span><span class="RktVar">pattern-directive</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:declare</span><span class="hspace">&nbsp;</span><span class="RktVar">pattern-id</span><span class="hspace">&nbsp;</span><span class="RktVar">syntax-class-id</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:declare</span><span class="hspace">&nbsp;</span><span class="RktVar">pattern-id</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">syntax-class-id</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktVar">syntax-pattern</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:attr</span><span class="hspace">&nbsp;</span><span class="RktVar">attr-id</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:fail-when</span><span class="hspace">&nbsp;</span><span class="RktVar">condition-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">message-expr</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:fail-unless</span><span class="hspace">&nbsp;</span><span class="RktVar">condition-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">message-expr</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktVar">condition-expr</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">#:do</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVar">def-or-expr</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">]</span></td></tr></table></p><p><div class="SIntrapara"><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:declare</span><span class="hspace">&nbsp;</span><span class="RktVar">pvar-id</span><span class="hspace">&nbsp;</span><span class="RktVar">syntax-class-id</span></td></tr></table></blockquote></div><div class="SIntrapara"><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:declare</span><span class="hspace">&nbsp;</span><span class="RktVar">pvar-id</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">syntax-class-id</span><span class="hspace">&nbsp;</span><span class="RktVar">arg</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></td></tr></table><p>The first form is equivalent to using the
<span class="RktVar">pvar-id:syntax-class-id</span> form in the pattern (but it is illegal
to use both for the same pattern variable).</p><p>The second form allows the use of parameterized syntax classes, which
cannot be expressed using the &ldquo;colon&rdquo; notation. The <span class="RktVar">arg</span>s
are evaluated outside the scope of any of the attribute bindings from
pattern that the <span class="RktPn">#:declare</span> directive applies to. Keyword
arguments are supported, using the same syntax as in <span class="RktSym"><a href="../reference/application.html#(form._((lib._racket/private/base..rkt)._~23~25app))" class="RktStxLink" pltdoc="x">#%app</a></span>.</p></blockquote></div></p><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:with</span><span class="hspace">&nbsp;</span><span class="RktVar">syntax-pattern</span><span class="hspace">&nbsp;</span><span class="RktVar">stx-expr</span></td></tr></table><p>Evaluates the <span class="RktVar">stx-expr</span> in the context of all previous
attribute bindings and matches it against the pattern. If the match
succeeds, the pattern&rsquo;s attributes are added to environment for the
evaluation of subsequent side conditions. If the <span class="RktPn">#:with</span> match
fails, the matching process backtracks. Since a syntax object may
match a pattern in several ways, backtracking may cause the same
clause to be tried multiple times before the next clause is reached.</p></blockquote><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:attr</span><span class="hspace">&nbsp;</span><span class="RktVar">attr-id</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span></td></tr></table><p>Evaluates the <span class="RktVar">expr</span> in the context of all previous attribute
bindings and binds it to the attribute named by <span class="RktVar">attr-id</span>. The
value of <span class="RktVar">expr</span> need not be syntax.</p></blockquote><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:fail-when</span><span class="hspace">&nbsp;</span><span class="RktVar">condition-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">message-expr</span></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">message-expr</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/strings.html#(def._((quote._~23~25kernel)._string~3f))" class="RktValLink" pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></td></tr></table><p>Evaluates the <span class="RktVar">condition-expr</span> in the context of all previous
attribute bindings. If the value is any true value (not <span class="RktVal">#f</span>),
the matching process backtracks (with the given message); otherwise,
it continues. If the value of the condition expression is a syntax
object, it is indicated as the cause of the error.</p><p>If the <span class="RktVar">message-expr</span> produces a string it is used as the
failure message; otherwise the failure is reported in terms of the
enclosing descriptions.</p></blockquote><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:fail-unless</span><span class="hspace">&nbsp;</span><span class="RktVar">condition-expr</span><span class="hspace">&nbsp;</span><span class="RktVar">message-expr</span></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" class="argcontract"><tr><td><span class="hspace">&nbsp;&nbsp;</span></td><td><span class="RktVar">message-expr</span></td><td><span class="hspace">&nbsp;</span></td><td>:</td><td><span class="hspace">&nbsp;</span></td><td><span class="RktPn">(</span><span class="RktSym"><a href="../reference/Data-structure_Contracts.html#(def._((lib._racket/contract/private/misc..rkt)._or/c))" class="RktValLink" pltdoc="x">or/c</a></span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/strings.html#(def._((quote._~23~25kernel)._string~3f))" class="RktValLink" pltdoc="x">string?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktPn">)</span></td></tr></table></td></tr></table><p>Like <span class="RktPn">#:fail-when</span> with the condition negated.</p></blockquote><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:when</span><span class="hspace">&nbsp;</span><span class="RktVar">condition-expr</span></td></tr></table><p>Evaluates the <span class="RktVar">condition-expr</span> in the context of all previous
attribute bindings. If the value is <span class="RktVal">#f</span>, the matching process
backtracks. In other words, <span class="RktPn">#:when</span> is like
<span class="RktPn">#:fail-unless</span> without the message argument.</p></blockquote><blockquote class="leftindent"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">#:do</span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktVar">def-or-expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">]</span></td></tr></table><p>Takes a sequence of definitions and expressions, which may be
intermixed, and evaluates them in the scope of all previous attribute
bindings. The names bound by the definitions are in scope in
the expressions of subsequent patterns and clauses.</p><p>There is currently no way to bind attributes using a <span class="RktPn">#:do</span>
block. It is an error to shadow an attribute binding with a definition
in a <span class="RktPn">#:do</span> block.</p></blockquote><h5>8.4.2<tt>&nbsp;</tt><a name="(part._.Pattern_variables_and_attributes)"></a>Pattern variables and attributes</h5><p>An <a name="(tech._attribute)"></a><span style="font-style: italic">attribute</span> is a name bound by a syntax pattern. An
attribute can be a <a href="stxparse-patterns.html#(tech._pattern._variable)" class="techoutside" pltdoc="x"><span class="techinside">pattern variable</span></a> itself, or it can be a
<a href="stxparse-patterns.html#(tech._nested._attribute)" class="techoutside" pltdoc="x"><span class="techinside">nested attribute</span></a> bound by an <a href="stxparse-patterns.html#(tech._annotated._pattern._variable)" class="techoutside" pltdoc="x"><span class="techinside">annotated pattern
variable</span></a>. The name of a nested attribute is computed by concatenating
the pattern variable name with the syntax class&rsquo;s exported attribute&rsquo;s
name, separated by a dot (see the example below).</p><p>Attribute names cannot be used directly as expressions; that is,
attributes are not variables. Instead, an attribute&rsquo;s value can be
gotten using the <span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._attribute))" class="RktStxLink" pltdoc="x">attribute</a></span> special form.</p><p><div class="SIntrapara"><table cellspacing="0" class="boxed"><tr><td><span class="RktPn">(</span><a name="(dep._((lib._syntax/parse..rkt)._attribute))"></a><a name="(form._((lib._syntax/parse..rkt)._attribute))"></a><span title="Provided from: syntax/parse"><span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._attribute))" class="RktStxLink" pltdoc="x">attribute</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">attr-id</span><span class="RktPn">)</span></td></tr></table></div><div class="SIntrapara">Returns the value associated with the attribute named
<span class="RktVar">attr-id</span>. If <span class="RktVar">attr-id</span> is not bound as an attribute, an
error is raised.</div></p><p>The value of an attribute need not be syntax. Non-syntax-valued
attributes can be used to return a parsed representation of a subterm
or the results of an analysis on the subterm. A non-syntax-valued
attribute should be bound using the <span class="RktPn">#:attr</span> directive or a
<span class="RktSym"><a href="stxparse-patterns.html#(form._((lib._syntax/parse..rkt)._~7ebind))" class="RktStxLink" pltdoc="x">~bind</a></span> pattern.</p><p><table cellspacing="0"><tr><td><p>Examples:</p></td></tr><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._define-syntax-class))" class="RktStxLink" pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">table</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._pattern))" class="RktStxLink" pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">key</span><span class="hspace">&nbsp;</span><span class="RktSym">value</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))" class="RktStxLink" pltdoc="x">...</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">#:attr</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/hashtables.html#(def._((quote._~23~25kernel)._hash))" class="RktValLink" pltdoc="x">hash</a></span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/for.html#(form._((lib._racket/private/base..rkt)._for/hash))" class="RktStxLink" pltdoc="x">for/hash</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">[</span><span class="RktSym">k</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/stxops.html#(def._((quote._~23~25kernel)._syntax-~3edatum))" class="RktValLink" pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">key</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))" class="RktStxLink" pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">v</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/stxops.html#(def._((quote._~23~25kernel)._syntax-~3edatum))" class="RktValLink" pltdoc="x">syntax-&gt;datum</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">value</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))" class="RktStxLink" pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/values.html#(def._((quote._~23~25kernel)._values))" class="RktValLink" pltdoc="x">values</a></span><span class="hspace">&nbsp;</span><span class="RktSym">k</span><span class="hspace">&nbsp;</span><span class="RktSym">v</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="Parsing_syntax.html#(form._((lib._syntax/parse..rkt)._syntax-parse))" class="RktStxLink" pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">t:table</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._attribute))" class="RktStxLink" pltdoc="x">attribute</a></span><span class="hspace">&nbsp;</span><span class="RktSym">t.hash</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">'#hash((a<span class="stt"> </span>. 1)<span class="stt"> </span>(c<span class="stt"> </span>. 3)<span class="stt"> </span>(b<span class="stt"> </span>. 2))</span></p></td></tr></table></p><p>A syntax-valued attribute is an attribute whose value is a syntax
object or a syntax list of the appropriate <a href="#(tech._ellipsis._depth)" class="techoutside" pltdoc="x"><span class="techinside">ellipsis
depth</span></a>. Syntax-valued attributes can be used within <span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._syntax))" class="RktStxLink" pltdoc="x">syntax</a></span>,
<span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/qqstx..rkt)._quasisyntax))" class="RktStxLink" pltdoc="x">quasisyntax</a></span>, etc as part of a syntax template. If a
non-syntax-valued attribute is used in a syntax template, a runtime
error is signalled.</p><p><table cellspacing="0"><tr><td><p>Examples:</p></td></tr><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="Parsing_syntax.html#(form._((lib._syntax/parse..rkt)._syntax-parse))" class="RktStxLink" pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">t:table</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktSym">t.key</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))" class="RktStxLink" pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">#&lt;syntax:95:0 (a b c)&gt;</span></p></td></tr><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="Parsing_syntax.html#(form._((lib._syntax/parse..rkt)._syntax-parse))" class="RktStxLink" pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">c</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">t:table</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktRdr">#'</span><span class="RktSym">t.hash</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="RktErr">t.hash: attribute is bound to non-syntax value: '#hash((a .</span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="RktErr">1) (c . 3) (b . 2)) at: t.hash</span></p></td></tr></table></p><p>Every attribute has an associated <a name="(tech._ellipsis._depth)"></a><span style="font-style: italic">ellipsis depth</span> that
determines how it can be used in a syntax template (see the discussion
of ellipses in <span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._syntax))" class="RktStxLink" pltdoc="x">syntax</a></span>). For a pattern variable, the ellipsis
depth is the number of ellipses the pattern variable &ldquo;occurs under&rdquo;
in the pattern. For a nested attribute the depth is the sum of the
pattern variable&rsquo;s depth and the depth of the attribute in the syntax
class. Consider the following code:</p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._define-syntax-class))" class="RktStxLink" pltdoc="x">define-syntax-class</a></span><span class="hspace">&nbsp;</span><span class="RktSym">quark</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._pattern))" class="RktStxLink" pltdoc="x">pattern</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">b</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))" class="RktStxLink" pltdoc="x">...</a></span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym"><a href="Parsing_syntax.html#(form._((lib._syntax/parse..rkt)._syntax-parse))" class="RktStxLink" pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktSym">some-term</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">y:quark</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))" class="RktStxLink" pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))" class="RktStxLink" pltdoc="x">...</a></span><span class="hspace">&nbsp;</span><span class="RktSym">z:quark</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktSym">some-code</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></p><p>The syntax class <span class="RktSym">quark</span> exports two attributes: <span class="RktSym">a</span> at
depth 0 and <span class="RktSym">b</span> at depth 1. The <span class="RktSym"><a href="Parsing_syntax.html#(form._((lib._syntax/parse..rkt)._syntax-parse))" class="RktStxLink" pltdoc="x">syntax-parse</a></span> pattern
has three pattern variables: <span class="RktSym">x</span> at depth 0, <span class="RktSym">y</span> at
depth 2, and <span class="RktSym">z</span> at depth 0. Since <span class="RktSym">x</span> and <span class="RktSym">y</span>
are annotated with the <span class="RktSym">quark</span> syntax class, the pattern also
binds the following nested attributes: <span class="RktSym">y.a</span> at depth 2,
<span class="RktSym">y.b</span> at depth 3, <span class="RktSym">z.a</span> at depth 0, and <span class="RktSym">z.b</span> at
depth 1.</p><p>An attribute&rsquo;s ellipsis nesting depth is <span style="font-style: italic">not</span> a guarantee that
its value has that level of list nesting. In particular, <span class="RktSym"><a href="stxparse-patterns.html#(form._((lib._syntax/parse..rkt)._~7eor))" class="RktStxLink" pltdoc="x">~or</a></span>
and <span class="RktSym"><a href="stxparse-patterns.html#(form._((lib._syntax/parse..rkt)._~7eoptional))" class="RktStxLink" pltdoc="x">~optional</a></span> patterns may result in attributes with fewer
than expected levels of list nesting.</p><p><table cellspacing="0"><tr><td><p>Example:</p></td></tr><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="Parsing_syntax.html#(form._((lib._syntax/parse..rkt)._syntax-parse))" class="RktStxLink" pltdoc="x">syntax-parse</a></span><span class="hspace">&nbsp;</span><span class="RktRdr">#'</span><span class="RktPn">(</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktPn">(</span><span class="RktSym"><a href="stxparse-patterns.html#(form._((lib._syntax/parse..rkt)._~7eor))" class="RktStxLink" pltdoc="x">~or</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x:id</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt)._......))" class="RktStxLink" pltdoc="x">...</a></span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym"><a href="../reference/stx-patterns.html#(form._((lib._racket/private/stxcase-scheme..rkt).__))" class="RktStxLink" pltdoc="x">_</a></span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="#(form._((lib._syntax/parse..rkt)._attribute))" class="RktStxLink" pltdoc="x">attribute</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">#f</span></p></td></tr></table></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;5.0.2&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }" /></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" pltdoc="x" onclick="return GotoPLTRoot(&quot;5.0.2&quot;);">top</a></span><span class="navright"><a href="Parsing_syntax.html" title="backward to &quot;8.3 Parsing syntax&quot;" pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="stxparse.html" title="up to &quot;8 Parsing and specifying syntax&quot;" pltdoc="x">up</a>&nbsp;&nbsp;<a href="stxparse-patterns.html" title="forward to &quot;8.5 Syntax patterns&quot;" pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>
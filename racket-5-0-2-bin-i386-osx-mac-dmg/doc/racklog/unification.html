<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text-html; charset=utf-8" /><title>5&nbsp;Unification</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="../racket.css" title="default" /><link rel="stylesheet" type="text/css" href="../scribble-style.css" title="default" /><script type="text/javascript" src="../scribble-common.js"></script></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" pltdoc="x"><span style="font-weight: bold">Racklog</span>:<span class="mywbr"> </span> Prolog-<wbr></wbr>Style Logic Programming in Racket</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="simple.html" class="tocviewlink" pltdoc="x">Simple Goals and Queries</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="predicates.html" class="tocviewlink" pltdoc="x">Predicates</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="racket-w-logic.html" class="tocviewlink" pltdoc="x">Using Conventional Racket Expressions in Racklog</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="backtracking.html" class="tocviewlink" pltdoc="x">Backtracking</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="" class="tocviewselflink" pltdoc="x">Unification</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="and-or.html" class="tocviewlink" pltdoc="x">Conjuctions and Disjunctions</a></td></tr><tr><td align="right">7&nbsp;</td><td><a href="lv-manip.html" class="tocviewlink" pltdoc="x">Manipulating Racklog Variables</a></td></tr><tr><td align="right">8&nbsp;</td><td><a href="cut.html" class="tocviewlink" pltdoc="x">The Cut (<span class="RktSym"><span class="RktStxLink">!</span></span>)</a></td></tr><tr><td align="right">9&nbsp;</td><td><a href="set-of.html" class="tocviewlink" pltdoc="x">Set Predicates</a></td></tr><tr><td align="right">10&nbsp;</td><td><a href="Racklog_Module_Language.html" class="tocviewlink" pltdoc="x">Racklog Module Language</a></td></tr><tr><td align="right">11&nbsp;</td><td><a href="glossary.html" class="tocviewlink" pltdoc="x">Glossary of Racklog Primitives</a></td></tr><tr><td align="right"></td><td><a href="doc-bibliography.html" class="tocviewlink" pltdoc="x">Bibliography</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>5&nbsp;</td><td><a href="" class="tocviewselflink" pltdoc="x">Unification</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">5.1&nbsp;</td><td><a href="#(part._.The_.Occurs_.Check)" class="tocviewlink" pltdoc="x">The Occurs Check</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">5.1<tt>&nbsp;</tt></span><a href="#(part._.The_.Occurs_.Check)" class="tocsubseclink" pltdoc="x">The Occurs Check</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;5.0.2&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }" /></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" pltdoc="x" onclick="return GotoPLTRoot(&quot;5.0.2&quot;);">top</a></span><span class="navright"><a href="backtracking.html" title="backward to &quot;4 Backtracking&quot;" pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Racklog: Prolog-Style Logic Programming in Racket&quot;" pltdoc="x">up</a>&nbsp;&nbsp;<a href="and-or.html" title="forward to &quot;6 Conjuctions and Disjunctions&quot;" pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>5<tt>&nbsp;</tt><a name="(part._unification)"></a>Unification</h3><p>When we say that a goal matches with a clause-head, we mean
that the predicate and argument positions line up.  Before
making this comparison, Racklog dereferences all already
bound logic variables.  The resulting structures are then
compared to see if they are recursively identical.  Thus,
<span class="RktVal">1</span> unifies with <span class="RktVal">1</span>, and <span class="RktPn">(</span><span class="RktSym"><a href="../reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktPn">)</span> with <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktVal">)</span>; but <span class="RktVal">1</span> and
<span class="RktVal">2</span> do not unify, and neither do <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">2</span><span class="RktVal">)</span> and <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">1</span><span class="stt"> </span><span class="RktVal">3</span><span class="RktVal">)</span>.</p><p>In general, there could be quite a few uninstantiated logic
variables in the compared objects.  Unification will then
endeavor to find the most natural way of binding these
variables so that we arrive at structurally identical
objects.  Thus, <span class="RktPn">(</span><span class="RktSym"><a href="../reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="stt"> </span><span class="RktVar">x</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktPn">)</span>, where <span class="RktVar">x</span> is an unbound logic
variable, unifies with <span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">0</span><span class="stt"> </span><span class="RktVal">1</span><span class="RktVal">)</span>, producing the
binding
<span class="RktPn">[</span><span class="RktVar">x</span><span class="stt"> </span><span class="RktVal">0</span><span class="RktPn">]</span>.</p><p>Unification is thus a goal, and Racklog makes the unification predicate
available  to the user as <span class="RktSym"><a href="glossary.html#(def._((lib._racklog/main..rkt)._~25~3d))" class="RktValLink" pltdoc="x">%=</a></span>.   Eg,</p><p><table cellspacing="0"><tr><td><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="glossary.html#(form._((lib._racklog/main..rkt)._~25which))" class="RktStxLink" pltdoc="x">%which</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="glossary.html#(def._((lib._racklog/main..rkt)._~25~3d))" class="RktValLink" pltdoc="x">%=</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="../reference/pairs.html#(def._((quote._~23~25kernel)._list))" class="RktValLink" pltdoc="x">list</a></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">'</span><span class="RktVal">(</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktVal">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;</span><span class="RktRes">'((x<span class="stt"> </span>. 0))</span></p></td></tr></table></p><p>Racklog also provides the predicate <span class="RktSym"><a href="glossary.html#(def._((lib._racklog/main..rkt)._~25/~3d))" class="RktValLink" pltdoc="x">%/=</a></span>, the <span style="font-style: italic">negation</span> of
<span class="RktSym"><a href="glossary.html#(def._((lib._racklog/main..rkt)._~25~3d))" class="RktValLink" pltdoc="x">%=</a></span>.  <span class="RktPn">(</span><span class="RktSym"><a href="glossary.html#(def._((lib._racklog/main..rkt)._~25/~3d))" class="RktValLink" pltdoc="x">%/=</a></span><span class="stt"> </span><span class="RktVar">X</span><span class="stt"> </span><span class="RktVar">Y</span><span class="RktPn">)</span> succeeds if and only if <span class="RktVar">X</span> does
<span style="font-style: italic">not</span> unify with <span class="RktVar">Y</span>.</p><p>Unification goals constitute the basic subgoals that all
Racklog goals devolve to.  A goal succeeds because all the
eventual unification subgoals that it decomposes to in at
least one of its subgoal-branching succeeded.  It fails
because every possible subgoal-branching was thwarted by the
failure of a crucial unification subgoal.</p><p>Going back to the example in <a href="backtracking.html" pltdoc="x">Backtracking</a>, the goal
<span class="RktPn">(</span><span class="RktSym">%computer-literate</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">Penelope</span><span class="RktPn">)</span> succeeds because
(a) it unified with
<span class="RktPn">(</span><span class="RktSym">%computer-literate</span><span class="stt"> </span><span class="RktSym">person</span><span class="RktPn">)</span>; and then (b) with the binding
<span class="RktPn">[</span><span class="RktSym">person</span><span class="stt"> </span><span class="RktPn">. </span><span class="RktSym">Penelope</span><span class="RktPn">]</span> in place, <span class="RktPn">(</span><span class="RktSym">%knows</span><span class="stt"> </span><span class="RktSym">person</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">TeX</span><span class="RktPn">)</span>
unified with <span class="RktPn">(</span><span class="RktSym">%knows</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">Penelope</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">TeX</span><span class="RktPn">)</span> and
<span class="RktPn">(</span><span class="RktSym">%knows</span><span class="stt"> </span><span class="RktSym">person</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">Prolog</span><span class="RktPn">)</span> unified with <span class="RktPn">(</span><span class="RktSym">%knows</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">Penelope</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">Prolog</span><span class="RktPn">)</span>.</p><p>In contrast, the goal <span class="RktPn">(</span><span class="RktSym">%computer-literate</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">Telemachus</span><span class="RktPn">)</span>
fails because, with <span class="RktPn">[</span><span class="RktSym">person</span><span class="stt"> </span><span class="RktPn">. </span><span class="RktSym">Telemachus</span><span class="RktPn">]</span>,
the subgoals <span class="RktPn">(</span><span class="RktSym">%knows</span><span class="stt"> </span><span class="RktSym">person</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">Racket</span><span class="RktPn">)</span> and
<span class="RktPn">(</span><span class="RktSym">%knows</span><span class="stt"> </span><span class="RktSym">person</span><span class="stt"> </span><span class="RktVal">'</span><span class="RktVal">Prolog</span><span class="RktPn">)</span> have no facts they can
unify with.</p><h4>5.1<tt>&nbsp;</tt><a name="(part._.The_.Occurs_.Check)"></a>The Occurs Check</h4><p>A robust unification algorithm uses the <a name="(tech._occurs._check)"></a><span style="font-style: italic">occurs check</span>, which ensures that a logic variable
isn&rsquo;t bound to a structure that contains itself.
Not performing the check can cause the unification
to go into an infinite loop in some cases.  On the
other hand, performing the occurs check greatly
increases the time taken by unification, even in cases
that wouldn&rsquo;t require the check.</p><p>Racklog uses the global parameter
<span class="RktSym"><a href="glossary.html#(def._((lib._racklog/main..rkt)._use-occurs-check~3f))" class="RktValLink" pltdoc="x">use-occurs-check?</a></span> to decide whether to
use the occurs check.  By default, this variable is
<span class="RktVal">#f</span>, ie, Racklog disables the occurs check.  To
enable the check,</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="glossary.html#(def._((lib._racklog/main..rkt)._use-occurs-check~3f))" class="RktValLink" pltdoc="x">use-occurs-check?</a></span><span class="hspace">&nbsp;</span><span class="RktVal">#t</span><span class="RktPn">)</span></p><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" style="color: #888;" type="text" value="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;5.0.2&quot;, &quot;../&quot;);" onfocus="this.style.color=&quot;black&quot;; this.style.textAlign=&quot;left&quot;; if (this.value == &quot;...search manuals...&quot;) this.value=&quot;&quot;;" onblur="if (this.value.match(/^ *$/)) { this.style.color=&quot;#888&quot;; this.style.textAlign=&quot;center&quot;; this.value=&quot;...search manuals...&quot;; }" /></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" pltdoc="x" onclick="return GotoPLTRoot(&quot;5.0.2&quot;);">top</a></span><span class="navright"><a href="backtracking.html" title="backward to &quot;4 Backtracking&quot;" pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Racklog: Prolog-Style Logic Programming in Racket&quot;" pltdoc="x">up</a>&nbsp;&nbsp;<a href="and-or.html" title="forward to &quot;6 Conjuctions and Disjunctions&quot;" pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>